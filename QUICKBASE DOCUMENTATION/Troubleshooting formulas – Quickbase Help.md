## Troubleshooting formulas

This article provides information on troubleshooting Quickbase formulas.

## Resolving incorrect type errors in formulas

Incorrect type errors occur when a formula function or operator expects a different data type than the one used in the formula or the one expected in the result.

### What is a data type?

In software, a data type is the type of value a variable has and what type of mathematical, relational, or logical operations can be applied to it without error. Most programming languages use the data type string for text, integer for whole numbers, and floating point for numbers with decimal points.

### Resolving incorrect type errors

To resolve incorrect type errors, use a [type conversion function](http://www.quickbase.com/db/6ewwzuuj?a=q&qid=6) to convert one or more data types in your formula.Â 

### Date and work date errors

<table><tbody><tr><td><span><strong>Error</strong></span></td><td><span><strong>Solution</strong></span></td></tr><tr><td><p><span>Work dates and dates don't match</span></p></td><td><p><span>Use the ToDate() function to convert a work date to a date</span></p></td></tr></tbody></table>

### Solutions

<table><tbody><tr><td><span><strong>Goal</strong></span></td><td><span><strong>Error details</strong></span></td><td><span><strong>Type conversion solution</strong></span></td></tr><tr><td><span>Find the duration between two dates</span></td><td><p><span><strong>Field type:<br></strong>Formula - Duration<br></span></p><p><span><strong>Formula in error:</strong><br></span><span><code>[Actual Finish]-[Actual Start]</code></span></p><p><span><strong>Why it doesn't work:</strong><br>[Actual Finish] is a Date field and [Actual Start] is a Work Date field<br></span></p></td><td><p><span><strong>Solution:</strong><br></span><span>Convert [Actual Start] to a date value</span></p><p><span><strong>Revised formula:</strong></span><span><br><span><code>[Actual Finish]-ToDate([Act</code></span>ual Start])<br></span></p></td></tr><tr><td><span>Find the duration between two date/time values</span></td><td><p><span><strong><span>Field type:<br></span></strong>Formula - Numeric</span></p><p><span><strong>Formula in error:</strong></span><br><span><code>WeekdaySub([Date Modified],[Date Created])</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong>[Date Modified] and [Date Created] are Date / Time type fields</span><br></span></p></td><td><p><span><span><strong>Solution:</strong><br></span>Convert Date/Time fields to Date fields</span></p><p><span><strong>Revised formula:<br></strong></span><span><code>WeekdaySub(ToDate([Date Modified]),ToDate([Date Created]))</code></span></p></td></tr><tr><td><span>Generate a date that's two weekdays after the event in a date / Time field</span></td><td><p><span><span><strong>Field type:</strong><br></span>Formula - Date</span></p><p><span><strong>Formula in error:</strong></span><br><span><code>Weekdayadd ([date of meeting], 2)</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong></span></span><span>[Date of meeting] is a Date / Time type field</span></p></td><td><p><span><span><strong>Solution:</strong><br></span>Convert the result to a date</span></p><div><p><span><strong>Revised formula:<br></strong><code>ToDate(Weekdayadd ([date of meeting], 2))</code></span></p></div></td></tr></tbody></table>

### Numbers, dates, and duration errors

<table><tbody><tr><td><span><strong>Error</strong></span></td><td><span><strong>Solution</strong></span></td></tr><tr><td><p><span>Numbers don't mix with dates and durations</span></p></td><td><p><span>Convert the number to a duration using a function like Days()</span></p></td></tr></tbody></table>

### Solutions

<table><tbody><tr><td><span><strong>Goal</strong></span></td><td><strong><span>Error details</span></strong></td><td><span><strong>Type conversion solution</strong></span></td></tr><tr><td><p><span>Calculate how many gallons are used per hour</span></p><p>Note: You must understand what units the numeric value has and then select the corresponding conversion formula - ie hours vs days.</p><p></p></td><td><p><span><span><strong>Field type:</strong><br></span>Formula - Numeric</span></p><p><span><span><strong>Formula in error:</strong></span><br></span><span><code>[gallons consumed] / [hours of operation]</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong>[Gallons consumed] is a Numeric type field and [hours of operation] is a Duration type field</span><br></span></p></td><td><p><span><span><strong>Solution:</strong><br></span>Convert the duration into a number</span></p><p><span><strong>Revised formula:<br></strong></span><span><code>[gallons consumed]/ToHours<br>([hours of operation])</code></span></p></td></tr><tr><td><span>Calculate the difference between the days estimated to complete a job versus the actual days it took</span></td><td><p><span><strong><span>Field type:<br></span></strong>Formula - Numeric</span></p><p><span><span><strong>Formula in error:</strong></span><br></span><span><code>[Estimated Duration] - [Actual Duration]</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong>[Estimated Duration] is a numeric field. [Actual Duration] is a Formula - Duration type field<strong><br></strong></span></span></p></td><td><p><span><span><strong>Solution:</strong><br></span>Use the ToDays function to convert the duration into a numeric value that shows the number of days</span></p><p><span><strong>Revised formula:</strong><br></span><span><code>[Estimated Duration] - ToDays([Actual Duration])</code></span></p></td></tr><tr><td><span>Find the number of months between two dates</span></td><td><p><span><strong><span>Field type:<br></span></strong>Formula - Numeric</span></p><p><span><strong>Formula in error:</strong></span><br><span><code>[end date] - [start date])/30</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong>[end date] and [start date] are both Date fields<strong><br></strong></span></span></p></td><td><p><span><span><strong>Solution:</strong><br></span>Convert the number 30 to days</span></p><p><span><strong>Revised formula:</strong></span><br><span><code>(([End Date] - [Start Date]) / Days(30))</code></span></p></td></tr><tr><td><span>Calculate depreciation based on time passed</span></td><td><p><span><strong><span>Field type:<br></span></strong>Formula - Numeric</span></p><p><span><strong>Formula in error:</strong></span><br><span><code>[elapsed months]*[depreciation this period]</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong></span></span><span><span>[elapsed months] is a Formula -Duration type field and [depreciation] is a Numeric field.</span></span></p></td><td><p><span><span><strong>Solution:</strong><br></span>Convert the duration value so you can multiply by it.</span></p><p><span><strong>Revised formula:</strong></span><br><span><code>ToNumber([elapsed months])*[depreciation this period]</code></span></p></td></tr><tr><td><span>Calculate a task's finish date, based on the start date and number entered in the [Estimated # of Days] field.</span></td><td><p><strong><span><span>Field type:<br></span></span></strong><span>Formula - Date</span></p><p><span><strong>Formula in error:</strong></span><br><span><code>[Actual Start Date]+ [Estimated # of days]</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong></span></span><span><span>[Estimated # of days] field is a Numeric field.</span></span></p></td><td><p><span><span><strong>Solution:</strong></span><br>Use the Days function to convert the number to a duration value of days</span></p><p><span><strong>Revised formula:</strong></span><br><span><code>[Actual Start Date]+ Days([Estimated # of days])</code></span></p></td></tr></tbody></table>

### Literal errors

<table><tbody><tr><td><p><span><strong>Error</strong></span></p></td><td><span><strong>Solution</strong></span></td></tr><tr><td><p><span>Literals often need to be converted to a data type (<a href="https://helpv2.quickbase.com/hc/en-us/articles/18313319756692">What's a literal?</a>)</span></p></td><td><p><span>Use a conversion function to change the result to a different data type.</span></p></td></tr></tbody></table>

### Solutions

<table><tbody><tr><td><strong><span>Goal</span></strong></td><td><strong><span>Error details</span></strong></td><td><span><strong>Type conversion solution</strong></span></td></tr><tr><td><span>Use Ebenezer red to color projects assigned to a user</span></td><td><p><strong><span><span>Field type:</span></span></strong></p><p><span>Formula - Checkbox (in Report Builder)</span></p><p><span><strong>Formula in error:</strong></span><br><span><code>If([Project Lead]="Ebenezer", "pink", "")</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong>[Project Lead] is a User type field</span><br></span></p></td><td><p><span><strong>Solution:</strong><br>Use the ToUser() function to send an email.</span></p><p><span><strong>Revised formulas:</strong></span></p><div><p><span>Send by email:</span><br><span><code>If([Project Lead]=ToUser("Ebenezer@ScroogeandMarley.biz"), "red", "")</code></span></p><p><span>Or send by user name:</span><br><span><code>If([Project Lead]=ToUser("EScrooge"), "red", "")</code></span></p></div></td></tr><tr><td><span>Mark records where start time is after 6 am</span></td><td><p><span><strong><span>Field type:<br></span></strong>Formula - Checkbox</span></p><p><span><strong>Formula in error:</strong></span><br><span><code>If([Start Time]&gt;"6:00 am", true, false)</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong>[Start Time] is a Time of Day type field<strong><br></strong></span><br></span></p></td><td><p><span><span><strong>Solution:</strong><br></span>Use a conversion function to specify what this text represents</span></p><p><span><strong>Revised formula:</strong></span><br><span><code>If([Start Time]&gt;ToTimeOfDay("6:00 am"), true, false)</code></span></p></td></tr></tbody></table>

### Boolean errors

<table><tbody><tr><td rowspan="2"><p><span><span><strong>Error</strong></span></span></p><p><span>Boolean (true or false - checkbox) values don't mix with numbers</span></p></td><td rowspan="2"><span><span><strong>Solution</strong></span></span><p><span>Use the ToNumber() function to change the result to a different data type.</span></p></td></tr></tbody></table>

### Solutions

<table><tbody><tr><td><strong><span>Goal</span></strong></td><td><strong><span>Formula in error</span></strong></td><td><span><strong>Type conversion solution</strong></span></td></tr><tr><td><span>Calculate the number of checkboxes turned on</span></td><td><p><span><span><strong>Field type:</strong></span><br>Formula - Numeric:</span></p><p><span><strong>Formula in error:</strong></span><br><span><code>[Checkbox1] + [Checkbox2] + [Checkbox3]....</code></span></p><p><span><span><strong>Why it doesn't work:<br></strong>Checkboxes cannot be added like numbers even though they represent Boolean values (1 or 0)</span><br></span></p></td><td><p><span><span><strong>Solution:</strong><br></span>Use the ToNumber() formula to return 1 for true or yes and a zero for false or no</span></p><p><span><strong>Revised formula:</strong></span><br><span><code>ToNumber([Checkbox1]) + ToNumber([Checkbox2]) + ...etc.</code></span></p></td></tr></tbody></table>

### Blank result errors

<table><tbody><tr><td><p><span><strong>Error</strong></span></p></td><td><span><strong>Solution</strong></span></td></tr><tr><td><p><span>Formula draws a blank</span></p></td><td><p><span>If a formula saves but appears blank in the report, another field called by the formula might be the issue. C</span><span>heck these things:</span></p><ul><li><p><span>Are all fields referenced by the formula part of your app?</span></p></li><li><p><span>Are formula fields working correctly?</span></p></li><li><p><span>Does a referenced field include unusual values?</span><br><span>e.g., if a formula calculates the result of one field divided by another , an error occurs if the divisor is 0.</span></p></li></ul></td></tr></tbody></table>

### Null function errors

<table><tbody><tr><td><strong><span>Error</span></strong></td><td colspan="2"><strong><span>Solution</span></strong></td></tr><tr><td><span>A formula that includes a <a href="https://helpv2.quickbase.com/hc/en-us/articles/16909898126612">null function</a> doesn't work</span></td><td colspan="2"><span>Go to the field's properties, select the table and field, and clear <em>Treat blank values as "0" in calculations</em></span></td></tr></tbody></table>

## Related

-   [Best practices: writing formulas](https://helpv2.quickbase.com/hc/en-us/articles/16909898126612)
    
-   [How real-time error checking works](https://helpv2.quickbase.com/hc/en-us/articles/18207543772692)
-   [Operator precedence in formulas](https://helpv2.quickbase.com/hc/en-us/articles/4570399302548-Operator-Precedence-in-Quickbase-Formulas-)